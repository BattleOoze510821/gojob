(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0d0d8ebb"],{2480:function(t,a,e){"use strict";var i=e("b775"),n={getTraces:function(t){return Object(i["a"])({url:"/traces",method:"get",params:t})},getTrace:function(t){return Object(i["a"])({url:"/traces/"+t,method:"get"})},cleanTrace:function(t){return Object(i["a"])({url:"/traces/clean",method:"post",data:t})},statisticToday:function(){return Object(i["a"])({url:"/statistic/today",method:"get"})},statisticWeek:function(){return Object(i["a"])({url:"/statistic/week",method:"get"})},statisticMonth:function(){return Object(i["a"])({url:"/statistic/month",method:"get"})},statisticAll:function(){return Object(i["a"])({url:"/statistic/all",method:"get"})}};a["a"]=n},7277:function(t,a,e){"use strict";e.r(a);var i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("el-row",{staticClass:"mgb20",attrs:{gutter:20}},[e("el-col",{attrs:{span:24}},[e("el-button",{staticStyle:{float:"right","margin-right":"10px"},attrs:{icon:"el-icon-refresh",size:"mini"},on:{click:t.handleRuntimeRefresh}},[t._v("刷新")])],1)],1),e("el-row",{staticClass:"mgb20",attrs:{gutter:20}},[e("el-col",{attrs:{span:6}},[e("el-card",{attrs:{shadow:"hover","body-style":{padding:"0px"}}},[e("div",{staticClass:"grid-content grid-con-4"},[e("i",{staticClass:"el-icon-monitor grid-con-icon"}),e("div",{staticClass:"grid-cont-left"},[e("div",{staticClass:"user-info-list"},[t._v("    运行模式："+t._s(t.runModeName))]),e("div",{staticClass:"user-info-list"},[t._v("    启动时间："+t._s(t.runtime.startTime))]),"cluster"==t.runtime.runMode?e("div",{staticClass:"user-info-list"},[t._v("\n                  调度节点：正常"+t._s(t.runtime.usableNodeAmount)+" 、\n              "),e("font",{staticStyle:{color:"red"}},[t._v("故障"+t._s(t.runtime.disabledNodeAmount))])],1):t._e(),e("div",{staticClass:"user-info-list"},[t._v("\n              数据库节点：正常"+t._s(t.runtime.usableDBAmount)+" 、\n              "),e("font",{staticStyle:{color:"red"}},[t._v("故障"+t._s(t.runtime.disabledDBAmount))])],1)])])])],1),e("el-col",{attrs:{span:6}},[e("el-card",{attrs:{shadow:"hover","body-style":{padding:"0px"}}},[e("div",{staticClass:"grid-content grid-con-1"},[e("i",{staticClass:"el-icon-news grid-con-icon"}),e("div",{staticClass:"grid-cont-right"},[e("div",{staticClass:"grid-num"},[t._v(t._s(t.runtime.jobCount))]),e("div",[t._v("任务数量")])])])])],1),e("el-col",{attrs:{span:6}},[e("el-card",{attrs:{shadow:"hover","body-style":{padding:"0px"}}},[e("div",{staticClass:"grid-content grid-con-2"},[e("i",{staticClass:"el-icon-copy-document grid-con-icon"}),e("div",{staticClass:"grid-cont-right"},[e("div",{staticClass:"grid-num"},[t._v(t._s(t.runtime.executeNodeCount))]),e("div",[t._v("执行节点数量")])])])])],1),e("el-col",{attrs:{span:6}},[e("el-card",{attrs:{shadow:"hover","body-style":{padding:"0px"}}},[e("div",{staticClass:"grid-content grid-con-3"},[e("i",{staticClass:"el-icon-s-operation grid-con-icon"}),e("div",{staticClass:"grid-cont-right"},[e("div",{staticClass:"grid-num"},[t._v(t._s(t.runtime.triggerTimes))]),e("div",[t._v("总调度次数")])])])])],1)],1),e("el-card",{attrs:{shadow:"hover","body-style":{height:"304px"}}},[e("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[e("span",[t._v("失败率TOP20")]),e("el-button",{staticStyle:{float:"right"},attrs:{icon:"el-icon-refresh",size:"small"},on:{click:t.handleStatisticRefresh}},[t._v("刷新")]),t._v(" \n      "),e("el-select",{staticStyle:{float:"right","margin-right":"10px"},attrs:{placeholder:"请选择",size:"small"},on:{change:t.handleStatisticChange},model:{value:t.range,callback:function(a){t.range=a},expression:"range"}},[e("el-option",{attrs:{label:"今天",value:"today"}}),e("el-option",{attrs:{label:"本周",value:"week"}}),e("el-option",{attrs:{label:"本月",value:"month"}}),e("el-option",{attrs:{label:"全部",value:"all"}})],1)],1),e("div",{style:{height:"300px"},attrs:{id:"myChart"}})])],1)},n=[],s=(e("7f7f"),e("b605")),o=e("2480"),r=e("5c96"),c={name:"dashboard",data:function(){return{range:"today",runModeName:"",runtime:{},loading:{}}},methods:{handleRuntimeRefresh:function(){var t=this;s["a"].getRuntime().then((function(a){a.data&&(t.runtime=a.data,"standalone"===a.data.runMode?t.runModeName="单机":t.runModeName="集群")}))},startLoading:function(){this.loading=r["Loading"].service({lock:!0,text:"统计中... ...",target:document.querySelector("#myChart"),background:"rgba(0,0,0,0.1)"})},handleStatisticRefresh:function(){this.handleStatisticChange()},handleStatisticChange:function(){"today"===this.range&&this.statisticToday(),"week"===this.range&&this.statisticWeek(),"month"===this.range&&this.statisticMonth(),"all"===this.range&&this.statisticAll()},statisticToday:function(){var t=this;this.startLoading(),o["a"].statisticToday().then((function(a){a.data&&t.handleChart(a.data),t.loading.close()})).catch((function(a){t.loading.close()}))},statisticWeek:function(){var t=this;this.startLoading(),o["a"].statisticWeek().then((function(a){a.data&&t.handleChart(a.data),t.loading.close()})).catch((function(a){t.loading.close()}))},statisticMonth:function(){var t=this;this.startLoading(),o["a"].statisticMonth().then((function(a){a.data&&t.handleChart(a.data),t.loading.close()})).catch((function(a){t.loading.close()}))},statisticAll:function(){var t=this;this.startLoading(),o["a"].statisticAll().then((function(a){a.data&&t.handleChart(a.data),t.loading.close()})).catch((function(a){t.loading.close()}))},handleChart:function(t){for(var a=this.$echarts.init(document.getElementById("myChart")),e=[],i=[],n=0;n<t.length;n++){var s=t[n];e.push(s.name),i.push(s.rate)}a.setOption({color:["#3398DB"],tooltip:{trigger:"axis",formatter:function(a){var e=a[0],i=e.dataIndex,n="<div><p>"+t[i].name+"</p></div>";return n+="<div><p>调度次数："+t[i].total+"</p></div>",n+="<div><p>调度成功次数："+t[i].succeed+"</p></div>",n+="<div><p>调度失败次数："+t[i].failed+"</p></div>",n+="<div><p>调度失败率："+t[i].rate+"% </p></div>",n}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:[{type:"category",data:e,axisLine:{lineStyle:{color:"#008acd"}},axisLabel:{interval:0,formatter:function(t,a){return t}}}],yAxis:[{type:"value",axisLabel:{show:!0,interval:"auto",formatter:"{value} %"},show:!0}],series:[{name:"执行失败率",type:"bar",barWidth:25,data:i}]})}},mounted:function(){this.handleRuntimeRefresh(),this.statisticToday()},computed:{role:function(){return"admin"===this.name?"超级管理员":"普通用户"}}},l=c,d=(e("87e1"),e("2877")),u=Object(d["a"])(l,i,n,!1,null,"34bb95d4",null);a["default"]=u.exports},"7f7f":function(t,a,e){var i=e("86cc").f,n=Function.prototype,s=/^\s*function ([^ (]*)/,o="name";o in n||e("9e1e")&&i(n,o,{configurable:!0,get:function(){try{return(""+this).match(s)[1]}catch(t){return""}}})},"87e1":function(t,a,e){"use strict";var i=e("ddd4"),n=e.n(i);n.a},b605:function(t,a,e){"use strict";var i=e("b775"),n={getRuntime:function(){return Object(i["a"])({url:"/runtimes",method:"get"})},getRunmode:function(){return Object(i["a"])({url:"/runtimes/runmode",method:"get"})}};a["a"]=n},ddd4:function(t,a,e){}}]);
//# sourceMappingURL=chunk-0d0d8ebb.20433df3.js.map